## CVE-2021-33623 PoC: NPM package [trim-newlines](https://www.npmjs.com/package/trim-newlines)

The `trim-newlines` package before 3.0.1 and 4.x before 4.0.1 for Node.js is vulnerable to Regular Expression Denial of Service (ReDoS) through the `.end()` method.

- [Advisory](https://github.com/advisories/GHSA-7p7h-4mm5-852v)
- [Fix commit](https://github.com/sindresorhus/trim-newlines/commit/25246c6ce5eea1c82d448998733a6302a4350d91)

### Steps to reproduce:

1. Create a directory with the `exploit.js` file.
2. Run `npm init` on the command line.
3. Install a vulnerable version of the package:
```npm i trim-newlines@4.0.0 --save```
4. To be able to run this package through "node" you need to downgrade "node-fetch":
```npm i node-fetch@2.6.6 --save```
5. Run the exploit:
```node exploit.js```
6. An exponential growth of time on each iteration proves the vulnerability.
